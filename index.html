<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NCLEX NEPAL || CV</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .step-content {
            display: none;
        }

        /* Hide all steps initially */
        .step-content.active {
            display: block;
        }

        /* Show only the active step */
    </style>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

</head>

<body>

    <div class="container mt-5">
        <h2>GENERATE YOUR CV </h2>

        <!-- Stepper Navigation -->
        <div class="row text-center mb-3">
            <div class="col stepper-step step-1">Get Started</div>
            <div class="col stepper-step step-2">Personal Details</div>
            <div class="col stepper-step step-3">Objectives</div>
            <div class="col stepper-step step-4">Experience</div>
            <div class="col stepper-step step-5">Education</div>
            <div class="col stepper-step step-6">Training & Certificate</div>
            <div class="col stepper-step step-7">Language</div>
            <div class="col stepper-step step-8">Specializations and Skills</div>
            <div class="col stepper-step step-9">References</div>
        </div>

        <!-- Step 1: Personal Details -->
        <div id="step-content-1" class="step-content active">
            <h3>Get Started</h3>
            <!-- Hero Section -->
            <section class="hero bg-primary text-white text-center py-5">
                <div class="container">
                    <h1 class="display-4 mb-4">Generate Your Professional CV</h1>
                    <p class="lead mb-4">Create a stunning CV in minutes with our easy-to-use generator tool.</p>
                </div>
            </section>
        </div>
        <!-- Step 1: Personal Details -->
        <div id="step-content-2" class="step-content">
            <h3>Personal Details</h3>
            <div id="persionalInfo"></div>
        </div>

        <!-- Step 2: Objectives -->
        <div id="step-content-3" class="step-content">
            <h3>Objectives</h3>
            <div id="objective"></div>
        </div>

        <!-- Step 3: Experience -->
        <div id="step-content-4" class="step-content">
            <h3>Experience</h3>
            <div id="experience"></div>

        </div>

        <!-- Step 4: Education -->
        <div id="step-content-5" class="step-content">
            <h3>Education</h3>
            <div id="education"></div>

        </div>

        <!-- Step 5: Training & Certificate -->
        <div id="step-content-6" class="step-content">
            <h3>Training & Certificate</h3>
            <div id="training"></div>

        </div>

        <!-- Step 6: Language -->
        <div id="step-content-7" class="step-content">
            <h3>Language</h3>
            <div id="language"></div>

        </div>

        <!-- Step 7: Specializations and Skills -->
        <div id="step-content-8" class="step-content">
            <h3>Specializations and Skills</h3>
            <div id="specialization"></div>

        </div>

        <!-- Step 8: References -->
        <div id="step-content-9" class="step-content">
            <h3>References</h3>
            <div id="reference"></div>

        </div>

        <!-- Navigation Buttons -->
        <div class="mt-4">
            <button type="button" class="btn btn-secondary" onclick="prevStep()">Previous</button>
            <button type="button" class="btn btn-primary" onclick="nextStep()">Next</button>
        </div>


        <div class="mt-4">
            <button type="button" class="btn btn-success" onclick="generatePDF()">Generate PDF</button>
        </div>

    </div>

    <script>
        let currentStep = 1; // Track the current step

        function showStep(step) {
            // Hide all steps and show only the active one
            document.querySelectorAll('.step-content').forEach(content => content.classList.remove('active'));
            document.getElementById(`step-content-${step}`).classList.add('active');

            // Update stepper step classes to highlight current step
            document.querySelectorAll('.stepper-step').forEach((stepEl, index) => {
                stepEl.classList.remove('text-primary', 'fw-bold');
                if (index + 1 === step) {
                    stepEl.classList.add('text-primary', 'fw-bold');
                }
            });
        }

        function nextStep() {
            if (currentStep < 9) {
                currentStep++;
                showStep(currentStep);
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                showStep(currentStep);
            }
        }
    </script>
    <script>

        // Reusable function to fetch and insert content into the target div and execute scripts
        function loadContent(fileName, targetId) {
            fetch(fileName)
                .then(response => response.text())
                .then(data => {
                    document.getElementById(targetId).innerHTML = data;
                    executeScripts(data);
                })
                .catch(error => console.error(`Error loading ${fileName}:`, error));
        }

        // Function to execute any scripts found in the fetched HTML content
        function executeScripts(content) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = content;
            const scripts = tempDiv.getElementsByTagName('script');

            for (let script of scripts) {
                const newScript = document.createElement('script');
                if (script.src) {
                    newScript.src = script.src;
                } else {
                    newScript.text = script.text;
                }
                document.head.appendChild(newScript);  // Append script to the document's head
            }
        }

        // Load content for all sections using the reusable function
        loadContent("persionalInfo.html", "persionalInfo");
        loadContent("objective.html", "objective");
        loadContent("experience.html", "experience");
        loadContent("education.html", "education");
        loadContent("training.html", "training");
        loadContent("language.html", "language");
        loadContent("specialization.html", "specialization");
        loadContent("reference.html", "reference");
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // Function to generate PDF
        function generatePDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            // Set font for PDF
            doc.setFont("helvetica");
            doc.setFontSize(12);
            let yPosition = 10;
            const maxWidth = 180;  // Maximum width for text
            const lineHeight = 10; // Line height for spacing between lines

            // Function to format dates as DD/MM/YYYY
            function formatDate(date) {
                return new Date(date).toLocaleDateString('en-GB'); // DD/MM/YYYY
            }

            // Function to add key-value pairs in the same line with wrapping
            function addContent(key, value) {
                const text = `${key}: ${value || 'Not provided'}`;
                const wrappedText = doc.splitTextToSize(text, maxWidth);
                wrappedText.forEach((line) => {
                    doc.text(line, 10, yPosition);
                    yPosition += lineHeight;
                    if (yPosition > 270) {
                        doc.addPage();
                        yPosition = 10;
                    }
                });
            }

            // Get form values for personal information
            const fullName = document.getElementById('fullName').value;
            const address = document.getElementById('address').value;
            const phone = document.getElementById('phone').value;
            const email = document.getElementById('email').value;
            const dob = document.getElementById('dob').value;
            const permanentAddress = document.getElementById('permanentAddress').value;
            const maritalStatus = document.getElementById('maritalStatus').value;
            const sex = document.getElementById('sex').value;
            const nationality = document.getElementById('nationality').value;
            const nclexState = document.getElementById('nclexState').value;

            // Format the date of birth
            const formattedDob = formatDate(dob);

            // Add personal information to the PDF
            addContent('NAME', fullName);
            addContent('Address', address);
            addContent('Phone', phone);
            addContent('Email', email);
            addContent('Date of Birth', formattedDob);
            addContent('Permanent Address', permanentAddress);
            addContent('Marital Status', maritalStatus);
            addContent('Sex', sex);
            addContent('Nationality', nationality);
            addContent('NCLEX Licensure State', nclexState);

            // Add Objectives Section
            const objectivesList = document.getElementById('objectives-list');
            const objectives = objectivesList.getElementsByTagName('textarea');
            if (objectives.length > 0) {
                doc.text('Objectives:', 10, yPosition);
                yPosition += 10;
                for (let i = 0; i < objectives.length; i++) {
                    const objectiveText = objectives[i].value.trim();
                    if (objectiveText) {
                        const wrappedText = doc.splitTextToSize(`• ${objectiveText}`, maxWidth);
                        wrappedText.forEach((line) => {
                            doc.text(line, 10, yPosition);
                            yPosition += lineHeight;
                        });
                    }
                }
            }

            // Add Work Experience Section
            const jobEntries = document.getElementsByClassName('job-entry');
            if (jobEntries.length > 0) {
                doc.text('Work Experience:', 10, yPosition);
                yPosition += 10;
                for (let i = 0; i < jobEntries.length; i++) {
                    const jobTitle = document.getElementById(`jobTitle${i + 1}`).value;
                    const unit = document.getElementById(`unit${i + 1}`).value;
                    const from = document.getElementById(`from${i + 1}`).value;
                    const to = document.getElementById(`to${i + 1}`).value;
                    const dutyHours = document.getElementById(`dutyHours${i + 1}`).value;
                    const hospitalName = document.getElementById(`hospitalName${i + 1}`).value;
                    const hospitalAddress = document.getElementById(`hospitalAddress${i + 1}`).value;
                    const dutiesList = document.getElementById(`duties-list-${i + 1}`).getElementsByTagName('textarea');
                    const equipmentList = document.getElementById(`equipment-list-${i + 1}`).getElementsByTagName('textarea');

                    addContent(`Job Title`, jobTitle);
                    addContent(`Unit`, unit);
                    addContent(`From`, formatDate(from));
                    addContent(`To`, formatDate(to));
                    addContent(`Duty Hours (per week)`, dutyHours);
                    addContent(`Hospital Name`, hospitalName);
                    addContent(`Hospital’s Address`, hospitalAddress);

                    if (dutiesList.length > 0) {
                        doc.text('Duties and Responsibilities:', 10, yPosition);
                        yPosition += 10;
                        for (let j = 0; j < dutiesList.length; j++) {
                            const duty = dutiesList[j].value.trim();
                            if (duty) {
                                const wrappedDuty = doc.splitTextToSize(`• ${duty}`, maxWidth);
                                wrappedDuty.forEach((line) => {
                                    doc.text(line, 10, yPosition);
                                    yPosition += lineHeight;
                                });
                            }
                        }
                    }

                    if (equipmentList.length > 0) {
                        doc.text('Equipment Used:', 10, yPosition);
                        yPosition += 10;
                        for (let k = 0; k < equipmentList.length; k++) {
                            const equipment = equipmentList[k].value.trim();
                            if (equipment) {
                                const wrappedEquipment = doc.splitTextToSize(`• ${equipment}`, maxWidth);
                                wrappedEquipment.forEach((line) => {
                                    doc.text(line, 10, yPosition);
                                    yPosition += lineHeight;
                                });
                            }
                        }
                    }
                }
            }

            // Add Education Section to the PDF
            const educationEntries = document.getElementsByClassName('education-entry');

            if (educationEntries.length > 0) {
                doc.text('Education:', 10, yPosition);
                yPosition += 10;

                for (let i = 0; i < educationEntries.length; i++) {
                    const degree = document.getElementById(`degree${i + 1}`).value;
                    const graduationYear = document.getElementById(`graduationYear${i + 1}`).value;
                    const percentage = document.getElementById(`percentage${i + 1}`).value;
                    const university = document.getElementById(`university${i + 1}`).value;
                    const universityAddress = document.getElementById(`universityAddress${i + 1}`).value;

                    addContent(`Degree`, degree);
                    addContent(`Graduation Year`, graduationYear);
                    addContent(`Percentage/Grade`, percentage);
                    addContent(`University Name`, university);
                    addContent(`University Address`, universityAddress);

                    if (yPosition > 270) {
                        doc.addPage();
                        yPosition = 10;
                    }
                }
            }

            // Add Training/Certificates Section to the PDF
            const trainingEntries = document.getElementsByClassName('training-entry');

            if (trainingEntries.length > 0) {
                doc.text('Training/Certificates:', 10, yPosition);
                yPosition += 10;

                // Loop through each training entry and add the details
                for (let i = 0; i < trainingEntries.length; i++) {
                    const trainingName = document.getElementById(`trainingName${i + 1}`).value;
                    const organization = document.getElementById(`organization${i + 1}`).value;
                    const trainingDate = document.getElementById(`trainingDate${i + 1}`).value;

                    // Add Training Information
                    addContent(`Training/Certificate Name`, trainingName);
                    addContent(`Issuing Organization`, organization);
                    addContent(`Date`, trainingDate);

                    // Check for page overflow after adding a training entry
                    if (yPosition > 270) {
                        doc.addPage();
                        yPosition = 10;
                    }
                }
            }
            // Get all language entries and add them to the PDF
            const languageEntries = document.getElementsByClassName('language-entry');

            if (languageEntries.length > 0) {
                doc.text('Language:', 10, yPosition);
                yPosition += 10;
                // Loop through each language entry and add the details
                for (let i = 0; i < languageEntries.length; i++) {
                    const language = document.getElementById(`language${i + 1}`).value;

                    // Add Language Information to the PDF
                    doc.text(`${i + 1}. ${language}`, 10, yPosition);
                    yPosition += 6;

                    // Check for page overflow and add a new page if necessary
                    if (yPosition > 270) {
                        doc.addPage();
                        yPosition = 10;
                    }
                }
            }

            // Loop through all specializations and skills and add them to the PDF
            const specializationEntries = document.getElementsByClassName('specialization-entry');
            if (specializationEntries.length > 0) {
                doc.text('Specialization:', 10, yPosition);
                yPosition += 10;

                for (let i = 0; i < specializationEntries.length; i++) {
                    // Get the specialization name for the current entry
                    const specializationName = document.getElementById(`specialization${i + 1}`).value;

                    // Add the specialization to the PDF
                    doc.text(`• Specialization: ${specializationName}`, 10, yPosition);
                    yPosition += 6;

                    // Add Skills for the current specialization
                    doc.text('• Skills:', 10, yPosition);
                    yPosition += 6;

                    // Get the skill entries for the current specialization
                    const skillEntries = document.getElementById(`skills-entries-container-${i + 1}`).getElementsByClassName('skill-entry');

                    // Loop through the skill entries for the current specialization
                    for (let j = 0; j < skillEntries.length; j++) {
                        // Get the skill for the current entry
                        const skill = document.getElementById(`skill${i + 1}-${j + 1}`).value;

                        // Add the skill to the PDF
                        doc.text(`• ${skill}`, 10, yPosition);
                        yPosition += 6;
                    }

                    // Check for page overflow and add a new page if necessary
                    if (yPosition > 270) {
                        doc.addPage();
                        yPosition = 10;
                    }
                }


            }

            // Loop through all reference entries and add them to the PDF
            const referenceEntries = document.getElementsByClassName('reference-entry');

            if (referenceEntries.length > 0) {
                doc.text('References:', 10, yPosition);
                yPosition += 10;

                for (let i = 0; i < referenceEntries.length; i++) {
                    const referenceName = document.getElementById(`referenceName${i + 1}`).value;
                    const position = document.getElementById(`position${i + 1}`).value;
                    const organization = document.getElementById(`organization${i + 1}`).value;
                    const contactInfo = document.getElementById(`contactInfo${i + 1}`).value;

                    // Add Reference details to PDF
                    doc.text(`${i + 1}. ${referenceName}`, 10, yPosition);
                    yPosition += 6;
                    doc.text(`   Position: ${position}`, 10, yPosition);
                    yPosition += 6;
                    doc.text(`   Organization: ${organization}`, 10, yPosition);
                    yPosition += 6;
                    doc.text(`   Contact Information: ${contactInfo}`, 10, yPosition);
                    yPosition += 10;  // Add some space after each reference

                    // Check for page overflow and add a new page if necessary
                    if (yPosition > 270) {
                        doc.addPage();
                        yPosition = 10;
                    }
                }

            }

            // Save the PDF
            doc.save('newcv.pdf');
        }

    </script>
</body>

</html>